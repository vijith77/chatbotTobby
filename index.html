<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Fashion Product Assistant</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Segoe UI', sans-serif; }

    body {
      background: linear-gradient(135deg, #6a11cb 0%, #2575fc 100%);
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
      transition: background 0.3s;
    }

    body.dark {
      background: linear-gradient(135deg, #1f1f1f 0%, #434343 100%);
    }

    .container {
      width: 100%;
      max-width: 1000px;
      background: white;
      border-radius: 15px;
      box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      transition: background 0.3s, color 0.3s;
    }

    body.dark .container {
      background: #2b2b2b;
      color: #ddd;
    }

    .header {
      background: linear-gradient(90deg, #4b6cb7 0%, #182848 100%);
      color: white;
      padding: 20px;
      text-align: center;
      position: relative;
    }

    .header h1 { font-size: 1.8rem; margin-bottom: 5px; }
    .header p { font-size: 1rem; opacity: 0.9; }

    .avatar {
      position: absolute;
      top: 15px;
      left: 20px;
      width: 50px;
      height: 50px;
      background: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 4px 10px rgba(0,0,0,0.2);
    }

    .avatar i { font-size: 24px; color: #4b6cb7; }

    .theme-toggle {
      position: absolute;
      top: 20px;
      right: 20px;
      background: rgba(255,255,255,0.2);
      border: none;
      border-radius: 50%;
      width: 40px;
      height: 40px;
      color: white;
      font-size: 18px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .theme-toggle:hover { background: rgba(255,255,255,0.4); }

    .chat-container {
      display: flex;
      height: 500px;
    }

    .sidebar {
      width: 250px;
      background: #f5f7fb;
      padding: 20px;
      border-right: 1px solid #e1e4e8;
      overflow-y: auto;
    }
    body.dark .sidebar { background: #3a3a3a; border-right-color: #444; }

    .sidebar h3 { margin-bottom: 15px; color: #2d3748; font-size: 1.2rem; }
    body.dark .sidebar h3 { color: #eee; }

    .sample-questions { list-style: none; }
    .sample-questions li {
      background: white;
      margin-bottom: 10px;
      padding: 10px;
      border-radius: 8px;
      cursor: pointer;
      box-shadow: 0 2px 5px rgba(0,0,0,0.05);
      transition: transform 0.2s, box-shadow 0.2s, background 0.3s;
      font-size: 0.9rem;
    }
    .sample-questions li:hover {
      transform: translateY(-2px);
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      background: #e9f2ff;
    }
    body.dark .sample-questions li { background: #444; color: #ddd; }

    .chat-box { flex: 1; display: flex; flex-direction: column; }
    .chat-messages {
      flex: 1; padding: 20px; overflow-y: auto;
      background: #fafafa;
    }
    body.dark .chat-messages { background: #2e2e2e; }

    .message {
      max-width: 80%;
      margin-bottom: 15px;
      padding: 12px 16px;
      border-radius: 18px;
      line-height: 1.4;
      animation: fadeIn 0.3s ease;
    }

    @keyframes fadeIn { from {opacity: 0; transform: translateY(10px);} to {opacity: 1; transform: translateY(0);} }

    .bot-message {
      background: #e9f2ff;
      border-bottom-left-radius: 5px;
      align-self: flex-start;
    }
    .user-message {
      background: #d1e7ff;
      border-bottom-right-radius: 5px;
      align-self: flex-end;
      margin-left: auto;
    }
    body.dark .bot-message { background: #4a5568; }
    body.dark .user-message { background: #2c5282; }

    .chat-input {
      display: flex;
      padding: 15px;
      border-top: 1px solid #e1e4e8;
      background: white;
    }
    body.dark .chat-input { background: #333; border-top-color: #444; }

    .chat-input input {
      flex: 1;
      padding: 12px 15px;
      border: 1px solid #d1d9e6;
      border-radius: 25px;
      outline: none;
      font-size: 1rem;
      transition: border 0.3s;
    }
    .chat-input input:focus { border-color: #4b6cb7; }
    body.dark .chat-input input { background: #444; border-color: #666; color: #fff; }

    .chat-input button {
      background: #4b6cb7;
      color: white;
      border: none;
      border-radius: 25px;
      padding: 0 20px;
      margin-left: 10px;
      cursor: pointer;
      transition: background 0.3s;
    }
    .chat-input button:hover { background: #3556a3; }

    @media (max-width: 768px) {
      .chat-container { flex-direction: column; height: auto; }
      .sidebar { width: 100%; border-right: none; border-bottom: 1px solid #e1e4e8; }
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="avatar"><i class="fas fa-tshirt"></i></div>
      <h1><i class="fas fa-robot"></i> Fashion Product Assistant</h1>
      <p>Precise product information for internal use</p>
      <button class="theme-toggle" id="themeToggle"><i class="fas fa-moon"></i></button>
    </div>

    <div class="chat-container">
      <div class="sidebar">
        <h3><i class="fas fa-lightbulb"></i> Sample Queries:</h3>
        <ul class="sample-questions">
          <li>Colors for product F1001</li>
          <li>Fits for product D2005</li>
          <li>Stock status for product S3002</li>
          <li>Materials for product J4008</li>
          <li>Price for product SW5012</li>
        </ul>
      </div>

      <div class="chat-box">
        <div class="chat-messages" id="chatMessages"></div>
        <div class="chat-input">
          <input type="text" id="userInput" placeholder="Ask about a product (e.g., Colors for F1001)...">
          <button id="sendButton"><i class="fas fa-paper-plane"></i></button>
        </div>
      </div>
    </div>
  </div>

  <script>
    const chatMessages = document.getElementById('chatMessages');
    const userInput = document.getElementById('userInput');
    const sendButton = document.getElementById('sendButton');
    const sampleQuestions = document.querySelectorAll('.sample-questions li');
    const themeToggle = document.getElementById('themeToggle');
    let products = {};

    // Load from localStorage
    function loadHistory() {
      const history = JSON.parse(localStorage.getItem('chatHistory')) || [];
      history.forEach(msg => addMessage(msg.text, msg.sender, false));
    }

    function saveHistory() {
      const messages = [...chatMessages.querySelectorAll('.message')].map(m => ({
        text: m.innerHTML,
        sender: m.classList.contains('user-message') ? 'user' : 'bot'
      }));
      localStorage.setItem('chatHistory', JSON.stringify(messages));
    }

    // Fetch product data
    fetch('products.json')
      .then(res => res.json())
      .then(data => {
        products = data;
        addMessage('<i class="fas fa-check-circle"></i> Product database loaded successfully! Ask away ðŸš€', 'bot');
      });

    sendButton.addEventListener('click', handleUserMessage);
    userInput.addEventListener('keypress', e => { if (e.key === 'Enter') handleUserMessage(); });
    sampleQuestions.forEach(q => q.addEventListener('click', () => { userInput.value = q.textContent; handleUserMessage(); }));

    function handleUserMessage() {
      const message = userInput.value.trim();
      if (!message) return;
      addMessage(message, 'user');
      userInput.value = '';
      setTimeout(() => {
        const response = generateBotResponse(message);
        addMessage(response, 'bot');
        saveHistory();
      }, 700);
    }

    function addMessage(text, sender, save = true) {
      const messageElement = document.createElement('div');
      messageElement.className = `message ${sender}-message`;
      messageElement.innerHTML = sender === 'bot' ? `<i class="fas fa-robot"></i> ${text}` : `<i class="fas fa-user"></i> ${text}`;
      chatMessages.appendChild(messageElement);
      chatMessages.scrollTop = chatMessages.scrollHeight;
      if (save) saveHistory();
    }

    function generateBotResponse(message) {
      const lowerMessage = message.toLowerCase();
      const productIdMatch = message.match(/([A-Za-z]?\d{4,5})/);
      if (!productIdMatch) return "Please include a valid product ID in your query (e.g., 'Colors for F1001').";
      const productId = productIdMatch[0].toUpperCase();
      if (!products[productId]) return `Product ${productId} not found.`;

      const product = products[productId];
      if (lowerMessage.includes('color')) return `Available colors: ${product.colorNames.join(', ')}`;
      if (lowerMessage.includes('fit')) return `Fits: ${product.fits.join(', ')}`;
      if (lowerMessage.includes('size')) return `Sizes: ${product.sizes.join(', ')}`;
      if (lowerMessage.includes('stock')) return product.inStock ? `In Stock (${product.stockCount} units)` : `Out of Stock`;
      if (lowerMessage.includes('material')) return `Material: ${product.material}`;
      if (lowerMessage.includes('price')) return `Price: $${product.price}`;
      return `Product: ${product.name} | ${product.description}`;
    }

    // Theme toggle
    themeToggle.addEventListener('click', () => {
      document.body.classList.toggle('dark');
      themeToggle.innerHTML = document.body.classList.contains('dark')
        ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
    });

    loadHistory();
  </script>
</body>
</html>
